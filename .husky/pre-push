if [ "$(git rev-parse @)" = "$(git rev-parse @{u})" ]; then
    echo "No changes to push."
    exit 0
fi

isStashed=false

if ! git diff-index --quiet HEAD --; then
    git stash push

    isStashed=true
fi

git push --no-verify -u origin "$(git branch --show-current)"

git fetch --tags --force

pnpm lerna version --yes

if [ "$isStashed" = true ]; then
    git stash pop
fi

git push -f --no-verify

